This HTML and JavaScript code provides a **mobile-first web application for capturing and uploading photos using the device's camera**. It's designed to be user-friendly, especially for mobile users, by enforcing landscape orientation and offering features like flash control and fullscreen mode.

---

## Key Features:

* **Mobile-First Design**: Ensures the application is optimized for mobile devices, including handling screen orientation.
* **Camera Integration**: Utilizes the `getUserMedia` API to access the device's camera (rear-facing by default) for live video streaming.
* **Photo Capture**: Allows users to capture still images from the live camera feed.
* **Image Optimization**: Captured images are resized to predefined `MAX_WIDTH` and `MAX_HEIGHT` for efficient processing and upload.
* **Flashlight/Torch Control**: Provides an option to toggle the device's flashlight (torch) if supported by the camera.
* **Fullscreen Mode**: Offers a fullscreen experience for an immersive camera view.
* **User Workflow**: Guides the user through a clear photo-taking process: start camera, capture, confirm, or retry.
* **Image Upload**: Sends the captured image as a PNG blob via AJAX to a specified `upload.php` endpoint.
* **Permissions Handling**: Includes basic handling for camera and geolocation permissions.
* **Bulgarian Localization**: User-facing messages and button texts are in Bulgarian.

---

## Technical Details:

* **HTML5**: Structures the web page with video, canvas, and control elements.
* **CSS3**: Styles the application for a responsive and visually appealing layout, including handling orientation-specific displays.
* **JavaScript**: Manages camera access, video streaming, image capture, canvas drawing, user interactions, and AJAX uploads.
* **jQuery**: Used for DOM manipulation and simplifying AJAX requests.
* **Material Design Icons**: Integrates icons from the Material Design Icons library for a modern look.
* **`ImageCapture` API**: Leverages this API for more direct camera control and photo capture capabilities (though it also includes a fallback to drawing from the video element).

---

## How it Works:

1.  **Initialization**: Upon loading, the script checks if the device is mobile and processes camera/geolocation permissions. It also checks the device's orientation, requiring landscape mode for interaction.
2.  **Start Camera**: When the "Старт" (Start) button is pressed, the application enters fullscreen, requests access to the device's rear camera, and displays the live feed.
3.  **Capture Photo**: The "Capture" button takes a still image from the video stream or directly from the camera using `ImageCapture`.
4.  **Review and Upload**: After capturing, the image is displayed on a canvas, and "Confirm" and "Retry" buttons appear. Users can confirm to upload the image or retry to take another photo.
5.  **Upload Process**: The confirmed image is converted to a PNG blob and sent to `upload.php` using a `FormData` object via AJAX. A loading indicator is shown during the upload.
6.  **Flash and Fullscreen**: Dedicated buttons allow users to toggle the flashlight and enter/exit fullscreen mode.

*This description was generated by Gemini 1.5 Pro.
